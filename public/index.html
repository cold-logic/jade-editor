<!DOCTYPE html>
<html>
<head>
	<meta http-equiv="Content-Type" content="text/html; charset=utf-8">
	<title>Cloud 9Â¾</title>
    
    <link rel="stylesheet" href="css/panes.css" type="text/css">
    <link rel="stylesheet" href="css/editors.css" type="text/css">
    <style type="text/css">
        body {
            margin: 0px;
        }
		
    </style>
	
    <!--
    <script src="//ajax.googleapis.com/ajax/libs/jquery/1.5.2/jquery.js" type="text/javascript"></script>
	-->
	
	<script src="js/3rdParty/jquery/jquery.js" type="text/javascript"></script>
	
	
    <script type="text/javascript" src="js/3rdParty/event.drag.touch/jquery.event.drag.js"></script>   
    <script src="js/3rdParty/ace/ace-uncompressed.js" type="text/javascript" charset="utf-8"></script>
    <script src="js/3rdParty/ace/mode-javascript.js" type="text/javascript" charset="utf-8"></script>
    <script src="js/3rdParty/ace/mode-css.js" type="text/javascript" charset="utf-8"></script>
    <script src="js/3rdParty/ace/mode-json.js" type="text/javascript" charset="utf-8"></script>
    <script src="js/3rdParty/ace/theme-solarized_light.js" type="text/javascript" charset="utf-8"></script>
	
	<!--
    <script src="js/3rdParty/ace/theme-twilight.js" type="text/javascript" charset="utf-8"></script>
    <script src="js/3rdParty/ace/theme-dawn.js" type="text/javascript" charset="utf-8"></script>
    <script src="js/3rdParty/ace/theme-clouds.js" type="text/javascript" charset="utf-8"></script>
    <script src="js/3rdParty/ace/theme-textmate.js" type="text/javascript" charset="utf-8"></script>
	-->
    
	
    <script src="js/templates.js"></script>
    <script src="js/3rdParty/jade/jade.js"></script>
	<script src="js/3rdParty/microevent/microevent.js"></script>
	<script src="js/panes.js"></script>
    <script src="js/editors.js"></script>
    
    <script type="text/javascript">
		//var suspendResize = false
		
        var init = function() {
			var $panes = $('#master')
			var panes = Panes.init($panes, { widthRatio: .61})
			
			
			editors.setPreview(window.frames[0].document); //find better cross-browser way for this
			
			var jade_editor = editors.createJade($panes.find('.jade')[0])
			var css_editor = editors.createCSS($panes.find('.css')[0])
			var json_editor = editors.createJSON($panes.find('.json')[0])
			var javascript_editor = editors.createJavascript($panes.find('.javascript')[0])
			
			editors.showPreview()
					
			panes.onresize(function() {
				jade_editor.resize()
				css_editor.resize()
				json_editor.resize()
				javascript_editor.resize()
			})
			
			
        }
		$(init)
		/*
		window.onblur = function() {
			console.log('blur')
			suspendResize = true
		}
		
		window.onfocus = function() {
			console.log('focus')
			suspendResize = false
		}
		*/
    </script>
    
    <script type="text/javascript">     
        function test() {
            function getHtml(id) {
                return document.getElementById(id).innerHTML.trim();
            }
            var expected = getHtml('expected');
            var actual = getHtml('actual');
            
            if(expected !== actual) { alert('Actual does not match expected standard') }
        }
    </script>
    <script type="text/javascript">
        function setupJade(jade_editor, preview) {
			var jade = jade_require('jade');
			
			var render = function() {
				preview.open()
				preview.write(jade.render(jade_editor[0].textContent))
				preview.close()
			}
			
			var spaceTabs = function(evt) {
				var isTab = (evt.keyCode === 9);
				if(isTab) {
					evt.preventDefault()
					return false;
				}	
			}
			
			render();
				
			jade_editor[0].addEventListener('keydown', spaceTabs, true);
			jade_editor[0].addEventListener('keyup', render, true);
        }
		
    </script>
</head>
<body>
	
	
	
    <div id="master" class="panes">
		<div class="pane top bottom left shadow">
			
			<div class="panes">
				<div class="pane top left shadow">
					<div class="jade">p Hello #{place}</div>
				</div>
				<div class="pane top right shadow">
					<div class="css">p {
	color: forestgreen;
	font-family: arial
}</div>
				</div>
				<div class="pane bottom left shadow">
					<div class="json">{
	place: "World"
}</div>
				</div>
				<div class="pane bottom right shadow">
					<div class="javascript">$('p').hide(1000).show(2000)</div>
				</div>
				<div class="sizer quad-sizer"></div>
			</div>
			
		</div>
		<div class="pane top bottom right shadow">
			<iframe class="preview"></iframe>
		</div>
		<div class="sizer horizontal-sizer"></div>
    </div>
	
</body>
</html>